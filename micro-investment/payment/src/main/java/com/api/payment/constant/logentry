22:57:41.146 [Thread-0] DEBUG org.springframework.boot.devtools.restart.classloader.RestartClassLoader - Created RestartClassLoader org.springframework.boot.devtools.restart.classloader.RestartClassLoader@45bc7c29

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::               (v2.7.11)

2024-07-23 22:57:42.013  INFO 17128 --- [  restartedMain] c.n.h.paymentapi.PaymentInitializer      : Starting PaymentInitializer using Java 17.0.4.1 on DESKTOP-GSQHGCK with PID 17128 (C:\Users\PKS\Documents\Gaya3\hackathon\feature-gayathri-branch\natwest-hackathon\target\classes started by PKS in C:\Users\PKS\Documents\Gaya3\hackathon\feature-gayathri-branch\natwest-hackathon)
2024-07-23 22:57:42.019  INFO 17128 --- [  restartedMain] c.n.h.paymentapi.PaymentInitializer      : No active profile set, falling back to 1 default profile: "default"
2024-07-23 22:57:42.180  INFO 17128 --- [  restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2024-07-23 22:57:42.180  INFO 17128 --- [  restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2024-07-23 22:57:45.807  INFO 17128 --- [  restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2024-07-23 22:57:45.829  INFO 17128 --- [  restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2024-07-23 22:57:45.831  INFO 17128 --- [  restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.74]
2024-07-23 22:57:46.049  INFO 17128 --- [  restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2024-07-23 22:57:46.052  INFO 17128 --- [  restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3870 ms
2024-07-23 22:57:50.442  INFO 17128 --- [  restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2024-07-23 22:57:50.468  INFO 17128 --- [  restartedMain] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
2024-07-23 22:57:50.639  INFO 17128 --- [  restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2024-07-23 22:57:50.679  INFO 17128 --- [  restartedMain] c.n.h.paymentapi.PaymentInitializer      : Started PaymentInitializer in 9.487 seconds (JVM running for 10.757)
2024-07-23 22:57:55.771  INFO 17128 --- [nio-8080-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2024-07-23 22:57:55.771  INFO 17128 --- [nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2024-07-23 22:57:55.773  INFO 17128 --- [nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
Inside getAccessToken
===log request start===
URI: {}https://ob.sandbox.natwest.com/token
Method: {}POST
Headers: {}[Accept:"application/json", Content-Type:"application/x-www-form-urlencoded;charset=UTF-8", Content-Length:"161"]
Request body: {}client_id=tyrShHgs3kXzV9uDRa1-c_GBZhxcJQSbckvxmM1mDk4%3D&client_secret=AmWwc7wbqFpt1zwg1hi5rniaGGYVjFOPWPrdbnuzDX0%3D&scope=payment&grant_type=client_credentials
===log request end===
===log response start===
Status code: {}200 OK
Status text: {}
Headers: {}[Content-Type:"application/json;charset=UTF-8", Transfer-Encoding:"chunked", Connection:"keep-alive", Cache-Control:"private, no-cache, no-store, max-age=0, must-revalidate", Pragma:"no-cache", X-Content-Type-Options:"nosniff", X-XSS-Protection:"1; mode=block", X-Frame-Options:"DENY", Date:"Tue, 23 Jul 2024 17:27:58 GMT", Access-Control-Allow-Origin:"*", Expires:"0"]
===log response end===
AccessTokenResponse [access_token=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhcHAiOiJkZW1vLWFwcC0zNjY4YThjYS0yNjczLTQzZWQtODRlNy00YWY1OGUyZDc1ZTciLCJvcmciOiIzNjY4YThjYS0yNjczLTQzZWQtODRlNy00YWY1OGUyZDc1ZTcuZXhhbXBsZS5vcmciLCJpc3MiOiJodHRwczovL2FwaS5zYW5kYm94Lm5hdHdlc3QuY29tIiwidG9rZW5fdHlwZSI6IkFDQ0VTU19UT0tFTiIsImV4dGVybmFsX2NsaWVudF9pZCI6InR5clNoSGdzM2tYelY5dURSYTEtY19HQlpoeGNKUVNiY2t2eG1NMW1EazQ9IiwiY2xpZW50X2lkIjoiNjdmMDA1MzQtMGQ1ZC00YzdiLThjNzAtZDVlZWViZmVjZWE4IiwibWF4X2FnZSI6ODY0MDAsImF1ZCI6IjY3ZjAwNTM0LTBkNWQtNGM3Yi04YzcwLWQ1ZWVlYmZlY2VhOCIsInNjb3BlIjoicGF5bWVudCIsImV4cCI6MTcyMTc1NjI3OCwiaWF0IjoxNzIxNzU1Njc4LCJqdGkiOiIwMTkxZDk3YS1iNTA3LTRhMGItYjRhNS1lZGUzNzhlMmZjMTEiLCJ0ZW5hbnQiOiJOYXRXZXN0In0.rs9F6VZJSpA-O5JSZZgcjR4U0D81qgjmICbO4eSCOivlnTZ0yMgVsgrejgXGZWX7cj8ildi9ItIf7rISKWMMan7WFzJUMZpGv77xUOt8MEZtxSwlihYGOsxcPsoBms8HzRYQwdYiJ_M0XCPyhwKaGgyAOv9fzhNUw_06ecwh6eeQkLLgi8FvbPTej7Q2M7yfhgILU1kcOL7aLxd4uwFjU1ZYEo498f_0Njbfhu7akoef_wGkEF1kBEuLOGbr1Y7aHbTWo7tUe4TUOLkNIbgPYo2rwRe6jgUgv5fZRnNW-cwMw7hmE209pmr1ZK1ehiP83IaDCR4EeDqkbC66thKrGQ, token_type=Bearer, expires_in=600, dummy=null]
Inside getPaymentConsent
===log request start===
URI: {}https://ob.sandbox.natwest.com/open-banking/v3.1/pisp/domestic-payment-consents
Method: {}POST
Headers: {}[Accept:"application/json, application/*+json", Authorization:"Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhcHAiOiJkZW1vLWFwcC0zNjY4YThjYS0yNjczLTQzZWQtODRlNy00YWY1OGUyZDc1ZTciLCJvcmciOiIzNjY4YThjYS0yNjczLTQzZWQtODRlNy00YWY1OGUyZDc1ZTcuZXhhbXBsZS5vcmciLCJpc3MiOiJodHRwczovL2FwaS5zYW5kYm94Lm5hdHdlc3QuY29tIiwidG9rZW5fdHlwZSI6IkFDQ0VTU19UT0tFTiIsImV4dGVybmFsX2NsaWVudF9pZCI6InR5clNoSGdzM2tYelY5dURSYTEtY19HQlpoeGNKUVNiY2t2eG1NMW1EazQ9IiwiY2xpZW50X2lkIjoiNjdmMDA1MzQtMGQ1ZC00YzdiLThjNzAtZDVlZWViZmVjZWE4IiwibWF4X2FnZSI6ODY0MDAsImF1ZCI6IjY3ZjAwNTM0LTBkNWQtNGM3Yi04YzcwLWQ1ZWVlYmZlY2VhOCIsInNjb3BlIjoicGF5bWVudCIsImV4cCI6MTcyMTc1NjI3OCwiaWF0IjoxNzIxNzU1Njc4LCJqdGkiOiIwMTkxZDk3YS1iNTA3LTRhMGItYjRhNS1lZGUzNzhlMmZjMTEiLCJ0ZW5hbnQiOiJOYXRXZXN0In0.rs9F6VZJSpA-O5JSZZgcjR4U0D81qgjmICbO4eSCOivlnTZ0yMgVsgrejgXGZWX7cj8ildi9ItIf7rISKWMMan7WFzJUMZpGv77xUOt8MEZtxSwlihYGOsxcPsoBms8HzRYQwdYiJ_M0XCPyhwKaGgyAOv9fzhNUw_06ecwh6eeQkLLgi8FvbPTej7Q2M7yfhgILU1kcOL7aLxd4uwFjU1ZYEo498f_0Njbfhu7akoef_wGkEF1kBEuLOGbr1Y7aHbTWo7tUe4TUOLkNIbgPYo2rwRe6jgUgv5fZRnNW-cwMw7hmE209pmr1ZK1ehiP83IaDCR4EeDqkbC66thKrGQ", Content-Type:"application/json", x-fapi-financial-id:"0015800000jfwxXAAQ", x-jws-signature:"DUMMY_SIG", x-idempotency-key:"c3cce7d1-8c72-4c92-aa7f-ea2c80851e1e", Content-Length:"645"]
Request body: {}{"scope":"payments","Data":{"ConsentId":null,"Initiation":{"CreditorAccount":{"Identification":"BE56456394728288","SecondaryIdentification":"secondary-identif","SchemeName":"IBAN","Name":"ACME DIY"},"DebtorAccount":null,"InstructionIdentification":"instr-identification","RemittanceInformation":{"Unstructured":"Tools","Reference":"Tools"},"InstructedAmount":{"Currency":"GBP","Amount":"50.00"},"EndToEndIdentification":"e2e-identification"},"Status":null,"StatusUpdateDateTime":null,"CreationDateTime":null},"Risk":{"DeliveryAddress":null,"MerchantCustomerIdentification":null,"PaymentContextCode":"EcommerceGoods","MerchantCategoryCode":null}}
===log request end===
===log response start===
Status code: {}403 FORBIDDEN
Status text: {}Forbidden
Headers: {}[Date:"Tue, 23 Jul 2024 17:28:00 GMT", Connection:"keep-alive", Content-Length:"35", Cache-Control:"private, no-cache, no-store, max-age=0, must-revalidate", Expires:"0"]
===log response end===
org.springframework.web.client.HttpClientErrorException$Forbidden: 403 Forbidden: "mandatory scope is missing payments"
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:109)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:168)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:122)
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63)
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:825)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:783)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:717)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:608)
	at com.natwest.hackathon.paymentapi.service.PaymentServiceImpl.getPaymentConsent(PaymentServiceImpl.java:104)
	at com.natwest.hackathon.paymentapi.service.PaymentServiceImpl.initiatePayment(PaymentServiceImpl.java:48)
	at com.natwest.hackathon.paymentapi.controller.PaymentController.paymentInitiation(PaymentController.java:22)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:529)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:833)
